<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <<title>New Expense</title>
        <link rel="stylesheet" href="/static/css/transactions.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
        <link rel="shortcut icon" href="/static/favicon.svg" type="image/svg+xml">
        <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
        <style>
            body,
            html {
                height: 100%;
                margin: 0;
                padding: 0;
                font-family: 'Inter', sans-serif;
            }

            .container {
                display: flex;
                height: 100%;
            }

            .sidebar {
                flex: 0 0 auto;
                background-color: #ffffff;
            }

            .center-content {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 200px;
            }

            .header {
                font-size: 36px;
                font-weight: bold;
                color: #272727;
                margin-bottom: 40px;
            }

            .file-upload {
                display: none;
            }

            .circle {
                border-radius: 1000px !important;
                overflow: hidden;
                width: 128px;
                height: 128px;
                border: 8px solid rgba(255, 255, 255, 0.7);
                position: relative;
                /* Changed position to relative */
                margin: 0 auto;
                /* Added margin to center horizontally */
                margin-top: 20px;
                /* Adjusted top margin to create space below headline */
            }

            .profile-pic {
                max-width: 100%;
                height: auto;
            }

            .p-image {
                position: relative;
                /* Changed position to relative */
                margin-top: -40px;
                /* Adjusted top margin to align with profile picture */
                margin-left: 80px;
                /* Adjusted left margin to align with profile picture */
                color: #666666;
                transition: all .3s cubic-bezier(.175, .885, .32, 1.275);
            }

            .p-image:hover {
                transition: all .3s cubic-bezier(.175, .885, .32, 1.275);
            }

            .upload-button {
                font-size: 1.2em;
            }

            .upload-button:hover {
                transition: all .3s cubic-bezier(.175, .885, .32, 1.275);
                color: #999;
            }

            /* Added style for input boxes */
            input[type="text"],
            input[type="email"],
            input[type="password"] {
                margin-top: 20px;
                /* Added margin-top to create space between input boxes */
                width: calc(100% - 20px);
                /* Adjusted width to fill the container */
                box-sizing: border-box;
                /* Added box-sizing to include padding and border in width calculation */
                padding: 10px;
                /* Added padding for better appearance */
                margin-bottom: 10px;
                /* Added margin-bottom to separate input boxes */
            }

            /* Adjusted the form container */
            .form-container {
                margin-top: 30px;
                /* Increased margin-top */
                height: auto;
                /* Changed height to auto */
                padding-bottom: 20px;
                /* Added padding to bottom to separate form from other elements */
            }

            h1 {
                margin-top: 10px;
                /* Increased margin-top */
            }
        </style>
</head>

<body class="collapsed">
    <div class="container">
        <nav class="sidebar">
            <div class="sidebar-top">
                <a href="/profile" class="logo__wrapper">
                    <img src="/static/images/logo.png" alt="Logo" class="logo">
                    <img src="/static/images/logo-small.png" alt="Logo" class="logo-small">
                </a>
            </div>
            <div class="sidebar-links">
                <ul>
                    <li>

                        <a href="/profile" title="" class="tooltip">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M5 12l-2 0l9 -9l9 9l-2 0"></path>
                                <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
                                <path d="M10 12h4v4h-4z"></path>
                            </svg>
                            <span class="link hide">Home</span>
                            <span class="tooltip__content">Home</span>
                        </a>
                    </li>




                    <li>
                        <a href="/MyGroups" title="" class="tooltip active">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-users"
                                width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"></path>
                                <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                <path d="M21 21v-2a4 4 0 0 0 -3 -3.85"></path>
                            </svg>
                            <span class="link hide">My Groups</span>
                            <span class="tooltip__content">My Groups</span>
                        </a>
                    </li>


                    <li>
                        <a href="/addGroup" title="" class="tooltip">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path
                                    d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z">
                                </path>
                            </svg>
                            <span class="link hide">Create Group</span>
                            <span class="tooltip__content">Create Group</span>
                        </a>
                    </li>



                    <li>
                        <a href="#" title="" class="tooltip" onclick="submitForm('/requests')">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M8 16l2 -6l6 -2l-2 6l-6 2"></path>
                                <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
                            </svg>
                            <span class="link hide">Pending Requests</span>
                            <span class="tooltip__content">Pending Requests</span>
                        </a>
                        <form id="myForm" action="/requests" method="post" style="display: none;">
                            <button type="submit">Pending Requests</button>
                        </form>
                    </li>



                    <li>
                        <a href="#" title="" class="tooltip" onclick="submitForm('/logout')">
                            <div style="position: relative;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-logout"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path
                                        d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2">
                                    </path>
                                    <path d="M9 12h12l-3 -3"></path>
                                    <path d="M18 15l3 -3"></path>
                                </svg>
                                <div class="notification"></div>
                            </div>
                            <span class="link hide">Logout</span>
                            <span class="tooltip__content">Logout</span>
                        </a>
                        <form id="myForm" action="/logout" method="post" style="display: none;">
                            <button type="submit">Logout</button>
                        </form>
                    </li>
                </ul>
            </div>


            <div class="sidebar-bottom hide">
                <img src="/static/images/diamond.png" alt="Diamond">
                <p>
                    Welcome to Splitwise!
                </p>
                <button>
                    Smart Sharing!
                </button>
            </div>
            <div class="expand-btn" style="display: hidden;">
                <img src="/static/images/right-collapse.svg" alt="Left Collapse">
                <span class="hide">
                    Collapse
                </span>
            </div>
            <!-- Other sidebar content if needed -->
        </nav>
        <div class="center-content">

            <div>

                <h1 style="padding-bottom: 15px;">Add New Expense</h1>
    <form action="/new_expense" method="post" id="expenseForm" style="max-width: 600px; margin: auto; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
        <div style="margin-bottom: 20px;">
            <label for="description" style="display: block; margin-top: 20px; font-weight: bold;">Enter Expense Description</label>
            <input id="description" type="text" name="description" required style="width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
        </div>
        <div >
            <input id="groupid" type="hidden" name="groupid" value="<%= groupid %>">
        </div>
        <div style="margin-bottom: 20px;">
            <label for="Amount" style="display: block; margin-top: 20px; font-weight: bold;"">Enter Total Amount</label>
            <input id="Amount" type="number" name="Amount" required style="width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
        </div>
        <div style="margin-bottom: 20px;">
            <label style="font-weight: bold;">Split Type:</label>
            <label style="margin-right: 10px;"><input type="radio" name="splitType" value="equal" checked style="margin-top: 5px;"> Equally</label>
            <label><input type="radio" name="splitType" value="custom" style="margin-top: 5px;"> Custom</label>
        </div>
        <div id="usersContainer"  style="margin-bottom: 20px;">
            <!-- Selected users will be displayed here -->
        </div>
        <div id="dropdownContainer" style="margin-bottom: 20px;">
            <input type="hidden" id="usersData" value='<%- JSON.stringify(results) %>'>
            <!-- Dropdown will be inserted here -->
        </div>
        <button type="button" onclick="showDropdown()" style="padding: 10px 20px; border-radius: 5px; background-color: #f6af33; color: white; border: none; cursor: pointer; margin-right: 10px; transition: background-color 0.3s;">Add User</button>
        <button type="submit" style="padding: 10px 20px; border-radius: 5px; background-color: #5a58e9; color: white; border: none; cursor: pointer; transition: background-color 0.3s;">Create Expense</button>
    </form>

    <script>
        function showDropdown() {
    var results = JSON.parse(document.getElementById('usersData').value);
    var dropdownContainer = document.getElementById('dropdownContainer');
    dropdownContainer.innerHTML = '';

    var select = document.createElement('select');
    select.name = 'selectedUserId';
    select.style = 'width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);';
    results.forEach(function (item) {
        var option = document.createElement('option');
        option.value = item.userId;
        option.text = item.Name;
        select.appendChild(option);
    });
    dropdownContainer.appendChild(select);

    select.addEventListener('change', function () {
        var selectedUserId = this.value;
        var selectedUserName = this.options[this.selectedIndex].text;

        var usersContainer = document.getElementById('usersContainer');
        usersContainer.style = 'margin-bottom: 20px;';

        var userDisplayContainer = document.createElement('div');
        userDisplayContainer.style = 'display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #f0f0f0; border-radius: 5px;';

        var userInputElement = document.createElement('input');
        userInputElement.type = 'hidden';
        userInputElement.value = selectedUserId;
        userInputElement.name = 'UserId';

        var userDisplayText = document.createElement('span');
        userDisplayText.textContent = selectedUserName + ' ';
        userDisplayText.style = 'flex-grow: 1;';

        userDisplayContainer.appendChild(userInputElement);
        userDisplayContainer.appendChild(userDisplayText);

        if (document.querySelector('input[name="splitType"]:checked').value === 'custom') {
            var ratioLabel = document.createElement('label');
            ratioLabel.textContent = 'Ratio: ';
            ratioLabel.style = 'margin-left: 10px;';

            // Slider input
            var ratioSlider = document.createElement('input');
            ratioSlider.type = 'range';
            ratioSlider.min = '0';
            ratioSlider.max = '1';
            ratioSlider.step = '0.01';
            ratioSlider.value = '0.5';
            ratioSlider.name = 'ratioSlider';
            ratioSlider.style = 'margin-left: 10px; width: 100px;';

            // Text input for manual ratio entry
            var ratioInput = document.createElement('input');
            ratioInput.type = 'number';
            ratioInput.value = '0.5';
            ratioInput.name = 'ratioInput';
            ratioInput.style = 'margin-left: 10px; width: 60px;';
            ratioInput.min = '0';
            ratioInput.max = '1';
            ratioInput.step = '0.01';

            // Synchronize slider and text input
            ratioSlider.oninput = function() {
                ratioInput.value = parseFloat(this.value).toFixed(2);
            };
            ratioInput.oninput = function() {
                ratioSlider.value = this.value;
            };

            userDisplayContainer.appendChild(ratioLabel);
            userDisplayContainer.appendChild(ratioSlider);
            userDisplayContainer.appendChild(ratioInput);
        }

        usersContainer.appendChild(userDisplayContainer);

        // Remove the selected option from the dropdown
        this.remove(this.selectedIndex);
    });
}
    </script>
    <script src="/static/js/transactions.js"></script>
</body>

</html>